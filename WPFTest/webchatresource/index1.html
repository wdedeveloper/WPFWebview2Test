<html>
<script>

window.chrome.webview.addEventListener('message', event => postJSONHandler(event.data));

window.chrome.webview.addEventListener('focus', focusHandler());
window.chrome.webview.addEventListener('blur', blurHandler());

window.chrome.webview.addEventListener('focusin', focusInHandler());
window.chrome.webview.addEventListener('focusout', focusOutHandler());


function postJSONHandler(data) {
	//alert(data);
	console.log(data);
	
	if(typeof data !== "undefined") {
		if(typeof data.action !== "undefined") {
			console.log("action is set " + data.action);
			if(data.action === "FOCUS")
				loadFunction();
			//else
			//	blurFunction();
			
		}
	}
}

function focusInHandler() {
	console.log("focus in index1");
	//loadFunction();
}
function focusOutHandler() {
	console.log("focus out index1");
	//loadFunction();
}

function focusHandler() {
	console.log("focus index1");
	//loadFunction();
}

function blurHandler() {
	console.log("blur index1");
	//blurFunction();
}


function postJSON2dotNet() {

  var msg = "[{'data1':'value1','data2':'value2'},{'data1':'value1','data2':'value2'}]";

  window.chrome.webview.postMessage(msg);
}

function callback2() {
  window.chrome.webview.postMessage('callback2');
}

function callback3() {
  window.chrome.webview.postMessage('callback3');
}

function focusElementJs() {
	console.log("Focused index1");
}

function focusElementBody() {
	console.log("Focused Body index1");
}

function blurElementJs() {
	console.log("Blured index1");
}

function blurElementBody() {
	console.log("Blured Body index1");
}

function loadFunction() {
	document.getElementById("inpTest").focus()
}

function blurFunction() {
	document.getElementById("inpTest").blur()
}

</script>
<body onload="loadFunction()" onFocus="focusElementBody()" onBlur="blurElementBody()">
<p>Toto raz bude chat stranka</p>
<div>
<button onclick="postJSON2dotNet()">CallBack 1</button>
<button onclick="callback2()" >CallBack 2</button>
<button onclick="callback3()" >CallBack 3</button>
<input id="inpTest" onFocus="focusElementJs()" onBlur="blurElementJs()" spellcheck="true"></input>
</div>
</body>
</html>